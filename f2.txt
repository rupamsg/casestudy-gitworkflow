pseudo code from feature2
