pseudo code from feature4
